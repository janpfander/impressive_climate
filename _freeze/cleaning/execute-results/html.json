{
  "hash": "40e7542d9873ed3989d674b496677df3",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Cleaning data\"\nformat: html\n\nexecute:\n  echo: true\n---\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\n```\n:::\n\n\n# Import data\n\n\n::: {.cell}\n\n```{.r .cell-code}\nd <- read_csv(\"./data/qualtrics.csv\")\nnames(d)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n [1] \"StartDate\"             \"EndDate\"               \"Status\"               \n [4] \"Progress\"              \"Duration (in seconds)\" \"Finished\"             \n [7] \"RecordedDate\"          \"ResponseId\"            \"DistributionChannel\"  \n[10] \"UserLanguage\"          \"Consent\"               \"Attention\"            \n[13] \"Competence_1\"          \"Intelligence_1\"        \"Qualification_1\"      \n[16] \"Honesty_1\"             \"Ethic_1\"               \"Sincerity_1\"          \n[19] \"Concern_1\"             \"Eagerness_1\"           \"Consideration_1\"      \n[22] \"Feedback_1\"            \"Transparency_1\"        \"Attentiveness_1\"      \n[25] \"Impressiveness\"        \"condition\"             \"PROLIFIC_PID\"         \n```\n\n\n:::\n:::\n\n\n\n# Rename variables\n\n\n::: {.cell}\n\n```{.r .cell-code}\nd <- d |> \n  rename_with(tolower) |> \n  # remove _1 at the end of variables\n  rename_with(~ sub(\"_1$\", \"\", .x))\n```\n:::\n\n\n# Codebook\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncodebook <- d |> \n  slice(1) |> \n  pivot_longer(everything(), \n               names_to = \"variable\", \n               values_to = \"description\") |> \n  # remove _1 at the end of string\n  mutate(variable = str_remove(variable, \"_1$\"))\n\ncodebook\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 27 × 2\n   variable              description          \n   <chr>                 <chr>                \n 1 startdate             Start Date           \n 2 enddate               End Date             \n 3 status                Response Type        \n 4 progress              Progress             \n 5 duration (in seconds) Duration (in seconds)\n 6 finished              Finished             \n 7 recordeddate          Recorded Date        \n 8 responseid            Response ID          \n 9 distributionchannel   Distribution Channel \n10 userlanguage          User Language        \n# ℹ 17 more rows\n```\n\n\n:::\n:::\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# inspect\nhead(d) # you can also use View(d)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 6 × 27\n  startdate enddate status progress duration (in seconds…¹ finished recordeddate\n  <chr>     <chr>   <chr>  <chr>    <chr>                  <chr>    <chr>       \n1 \"Start D… \"End D… \"Resp… \"Progre… \"Duration (in seconds… \"Finish… \"Recorded D…\n2 \"{\\\"Impo… \"{\\\"Im… \"{\\\"I… \"{\\\"Imp… \"{\\\"ImportId\\\":\\\"dura… \"{\\\"Imp… \"{\\\"ImportI…\n3 \"2025-11… \"2025-… \"IP A… \"100\"    \"102\"                  \"True\"   \"2025-11-04…\n4 \"2025-11… \"2025-… \"IP A… \"100\"    \"138\"                  \"True\"   \"2025-11-04…\n5 \"2025-11… \"2025-… \"IP A… \"100\"    \"153\"                  \"True\"   \"2025-11-04…\n6 \"2025-11… \"2025-… \"IP A… \"100\"    \"147\"                  \"True\"   \"2025-11-04…\n# ℹ abbreviated name: ¹​`duration (in seconds)`\n# ℹ 20 more variables: responseid <chr>, distributionchannel <chr>,\n#   userlanguage <chr>, consent <chr>, attention <chr>, competence <chr>,\n#   intelligence <chr>, qualification <chr>, honesty <chr>, ethic <chr>,\n#   sincerity <chr>, concern <chr>, eagerness <chr>, consideration <chr>,\n#   feedback <chr>, transparency <chr>, attentiveness <chr>,\n#   impressiveness <chr>, condition <chr>, prolific_pid <chr>\n```\n\n\n:::\n\n```{.r .cell-code}\n# delete first two rows\nd <- d %>% \n  slice(3: nrow(.)) \n```\n:::\n\n\n# Attention check\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# attention check\n# to see different answers given (i.e.levels), transform into factor\nd$attention <- as.factor(d$attention)\n# check levels to see different answer types\nlevels(d$attention) \n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n [1] \"\\\" I pay attention \\\"\"                                         \n [2] \"\\\"I pay attention\\\"\"                                           \n [3] \"i pay attention\"                                               \n [4] \"I pay attention\"                                               \n [5] \"I PAY ATTENTION\"                                               \n [6] \"I pay attention\\n\"                                             \n [7] \"I pay attention.\"                                              \n [8] \"I really dislike this game, it's the most overrated game ever.\"\n [9] \"the box below\"                                                 \n[10] \"Yes\"                                                           \n```\n\n\n:::\n\n```{.r .cell-code}\ntable(d$attention)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n                                           \" I pay attention \" \n                                                             1 \n                                             \"I pay attention\" \n                                                             4 \n                                               i pay attention \n                                                             6 \n                                               I pay attention \n                                                           434 \n                                               I PAY ATTENTION \n                                                             1 \n                                             I pay attention\\n \n                                                             2 \n                                              I pay attention. \n                                                             1 \nI really dislike this game, it's the most overrated game ever. \n                                                             1 \n                                                 the box below \n                                                             1 \n                                                           Yes \n                                                             1 \n```\n\n\n:::\n:::\n\n\nThere are three failed attention check. \n\n\n::: {.cell}\n\n```{.r .cell-code}\n# filter to only valid attention check responses\nd <- d %>% filter(str_detect(attention, \"attention\"))\n```\n:::\n\n\n# Re-shape data\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# check all names and their order\nnames(d)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n [1] \"startdate\"             \"enddate\"               \"status\"               \n [4] \"progress\"              \"duration (in seconds)\" \"finished\"             \n [7] \"recordeddate\"          \"responseid\"            \"distributionchannel\"  \n[10] \"userlanguage\"          \"consent\"               \"attention\"            \n[13] \"competence\"            \"intelligence\"          \"qualification\"        \n[16] \"honesty\"               \"ethic\"                 \"sincerity\"            \n[19] \"concern\"               \"eagerness\"             \"consideration\"        \n[22] \"feedback\"              \"transparency\"          \"attentiveness\"        \n[25] \"impressiveness\"        \"condition\"             \"prolific_pid\"         \n```\n\n\n:::\n:::\n\n\n## Trust in scientists \n\n### Benevolence \n\nThe survey has three items intended to capture the factor `benevolence`.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# do the re-naming and transform to numeric\nd <- d %>%\n  # syntax for rename() is new_name = old_name\n  rename(benevolence_concerned = concern, \n         benevolence_improve = eagerness,\n         benevolence_otherinterest = consideration\n         ) %>% \n  # For now, all variables containing numbers are coded as 'character'.\n  # We need them as numeric.\n  mutate(across(starts_with(\"benevolence\"), as.numeric))\n```\n:::\n\n\n### Competence\n\nThe main survey has three items intended to capture the factor `competence`.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# do the re-naming and transform to numeric\nd <- d %>%\n  # syntax for rename() is new_name = old_name\n  rename(competence_expert = competence, \n         competence_intelligent = intelligence,\n         competence_qualified = qualification\n         ) %>% \n  # For now, all variables containing numbers are coded as 'character'.\n  # We need them as numeric.\n  mutate(across(starts_with(\"competence\"), as.numeric))\n```\n:::\n\n\n### Integrity\n\nThe main survey has three items intended to capture the factor `integrity`.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# do the re-naming and transform to numeric\nd <- d %>%\n  # syntax for rename() is new_name = old_name\n  rename(integrity_honest = honesty, \n         integrity_ethical = ethic,\n         integrity_sincere = sincerity\n         ) %>% \n  # For now, all variables containing numbers are coded as 'character'.\n  # We need them as numeric.\n  mutate(across(starts_with(\"integrity\"), as.numeric))\n```\n:::\n\n\n### Openness \n\nThe main survey has three items intended to capture the factor `openness`.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# do the re-naming and transform to numeric\nd <- d %>%\n  # syntax for rename() is new_name = old_name\n  rename(openness_open = feedback, \n         openness_transparent = transparency,\n         openness_otherviews = attentiveness\n         ) %>% \n  # For now, all variables containing numbers are coded as 'character'.\n  # We need them as numeric.\n  mutate(across(starts_with(\"openness\"), as.numeric))\n```\n:::\n\n\n### Composite measure\n\nBased on the measures for `competence`, `benevolence`, `integrity` and `openness`, we build a composite variable `trust_composite`. Practically, this means that for our analysis, we will simply calculate the mean of all 12 items.\n\nWe also calculate separate measures for all sub-constructs.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nd <- d %>%\n  # calculate composite measure\n  mutate(trust = rowMeans(\n    across(starts_with(c(\"benevolence\", \"competence\", \"integrity\", \"openness\")) & contains(\"_\")), \n    na.rm = TRUE), \n    competence = rowMeans(across(starts_with('competence')), na.rm = TRUE),\n    benevolence = rowMeans(across(starts_with('benevolence')), na.rm = TRUE),\n    integrity = rowMeans(across(starts_with('integrity')), na.rm = TRUE),\n    openness = rowMeans(across(starts_with('openness')), na.rm = TRUE)\n  )\n```\n:::\n\n\n## Impressiveness\n\nOnly retain the numbers from the answer strings.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nd <- d |>\n  mutate(impressiveness = as.numeric(str_extract(impressiveness, \"\\\\d+\")))\n```\n:::\n\n\n## Condition\n\n\n::: {.cell}\n\n```{.r .cell-code}\nd <- d |> \n  mutate(\n    # the condition labeled \"combined\" really is a gratitude enhancing condition\n    condition = ifelse(condition == \"combination\", \"gratitude\", condition),\n    condition = factor(condition, \n                            levels = c(\"random\", \"control\", \"impressive\", \"gratitude\")\n                            )\n         )\n```\n:::\n\n\n\n# Demographics\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# prolific_demographics <- read_csv(\"./data/prolific.csv\")\n# \n# d <- left_join(d, prolific_demographics %>% select(-Age), by = c(\"PROLIFIC_PID\" = \"Participant id\"))\n```\n:::\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# d <- d %>% \n#   mutate(gender = case_when(Sex == \"Male\" ~ \"male\", \n#                             Sex == \"Female\" ~  \"female\", \n#                             .default = NA)\n#          ) \n```\n:::\n\n\n# Date\n\n\n::: {.cell}\n\n```{.r .cell-code}\nd <- d |> \n  mutate(date = format(as.Date(startdate), \"%B %d, %Y\")) \n```\n:::\n\n\n# Export data\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# store data\nwrite_csv(d, \"data/cleaned.csv\")\n\n# to prevent factor levels, save as RDS\nsaveRDS(d, \"data/cleaned.rds\")\n```\n:::\n\n",
    "supporting": [
      "cleaning_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}